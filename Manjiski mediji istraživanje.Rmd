---
title: "Proba:Mediji na jezicima nacionalnih manjina – istraživanje i analiza"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(readxl)
library(ggplot2)
library(plotly)
library(leaflet)
library(tidyverse)
library(htmltools)
library(htmlwidgets)
library(kableExtra)
library(writexl)
library(shinyWidgets)
library(shiny)
library(rmarkdown)


minoritymedia<-read_xlsx("manjinskimediji.xlsx")
#Number of minority media
totalminoritmedia<-minoritymedia%>%distinct(`Naziv medija`)
nrow(totalminoritmedia)

#za mapu
longlat<-read.csv("Longitude and latitude for cities.csv")
longlat<-longlat%>%
  select(-X)%>%
  rename(Grad=city)

longlat<-add_row(longlat, Grad = "MAGLIĆ", lng = 19.5296,  lat= 45.3528)
longlat<-add_row(longlat, Grad = "BARAJEVO", lng =20.4524 ,  lat= 44.6035)
longlat<-add_row(longlat, Grad = "TORAK", lng =20.6466 ,  lat= 45.4913)
combinedlonglat<-left_join(minoritymedia,longlat,by="Grad")
combinedlonglat[, 6:10][is.na(combinedlonglat[, 6:10])] <- " "



combinedlonglat<-combinedlonglat%>%
  distinct(`Naziv medija`,.keep_all = TRUE)

icon2<-awesomeIcons( icon="medium", library="fa", markerColor = "purple")

#bar chart za Broj medija po jeziku

barminoritymed<-minoritymedia%>%distinct(`Naziv medija`, .keep_all = TRUE)%>%
group_by(`Jezik`)%>%
   summarise(count=n())%>%
    rename (Broj_medija=count) %>%
  arrange (desc (Broj_medija)) %>%
  top_n(4)
  

  
   

 barminoritymed$`Jezik` <- factor (barminoritymed$`Jezik`,
  
                                 levels = c ("Mađarski","Albanski", "Bosanski", "Romski"))
 #tabela 
 
 minoritymedia1<-minoritymedia%>%select(-`URL`)
 

 
```

Istraživanje
=================================================================

Column {data-width=500}
-----------------------------------------------------------------------
### Broj manjinskih medija {data-height=150} 
```{r}
#creation of value box in upper left corner
valueBox (nrow(totalminoritmedia), icon = "fa-medium")
```

### **Mediji na jezicima nacionalnih manjina – istraživanje i analiza** {data-height=350, align=justify}

Predstavljamo vam sažeti pregled podataka prikupljenih tokom istraživanja koje je uradio konsultant Nedim Sejdinović. Podaci pokazuju da postoji trenutno `r nrow(totalminoritmedia)` medija na jezicima nacionalnih manjina. Sa desne strane vam je na raspolaganju mapa sa medijima gde mozete da vidite na kojim sve jezicima pružaju medijski sadržaji i koji tip medija je u pitanju.Ispod je grafikon koji prikazuje koliko medija pokriva određeni jezik. I na kraju imate pretraživu tabelu sa svim podacima koji su prikupljeni. Ukoliko želite da pročitate detaljnije izveštaj možete ga naći na sledećoj **web stranici**.  


### **Grafikon prikazuje četiri jezika sa najvećim brojem medija na kojima se pruža sadržaj na tom jeziku** {data-height=500}
```{r}
p <- ggplot (data = barminoritymed, aes (x = `Jezik`, y = `Broj_medija`))+
  
     geom_col (fill = "#AA23B4") +
  
     ylab ("Broj medija") +
  
     theme (legend.position = "none",
            
          panel.background = element_rect (fill = "lightcyan"))
  
# Turn it interactive with ggplotly

p <- ggplotly (p)

p
```

Column {data-width=500}
-----------------------------------------------------------------------
### **Mapa sa medijima koji pružaju sadržaj na manjinskim jezicima** 

```{r}

  m<-leaflet(combinedlonglat) %>% 
  addTiles()%>%
  setView(lng = 21.0059, lat = 44.0165, zoom = 7)%>%
  addAwesomeMarkers( icon = icon2, popup = ~paste(
    "Naziv medija:", `Naziv medija`, "<br>","Vrsta medija:",`Vrsta medija`, "<br>",
    "Jezici:",`Jezik`,`Ostali jezici 1`,`Ostali jezici 2`,`Ostali jezici 3`,`Ostali jezici 4`,`Ostali jezici 5`,"<br>",
    "Grad:",`Grad`,"<br>",
    "<a href='", `URL`, "' target='_blank'>"
                 , "Više informacija o mediju </a>","<br>"
  ),
clusterOptions = markerClusterOptions()
  )

m

```

Tabela
=============================================

### **Pretraživa tabela sa prikupljenim podacima o manjinskim medijima**

```{r}
DT :: datatable (minoritymedia1, rownames = FALSE,options = list(
  bPaginate = TRUE))
```

Dodatne informacije
=============================================

Column {data-width=1000}
-----------------------------------------------------------------------
### **Kontakt i podaci** {data-height=1000, align=justify}

Ukoliko smatrate da podaci treba da se ažuriraju slobodno kontaktirajte autora na sledeću email adresu: nedim.sejdinovic@gmail.com. 

Ova stranica je napravljena uz pomoć programskog jezika R i kod za njenu izradu kao i podatke u xls i csv formatu mozete naći na sledećoj [web adresi](https://github.com/tixwitchy/Minority-media).







